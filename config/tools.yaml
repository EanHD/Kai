# Tool Configuration
#
# Configure available tools for the LLM orchestrator.
# Tools are automatically invoked based on query analysis:
# - web_search: For current information, facts, news
# - rag: For personal memory retrieval (user preferences, schedules, goals)
# - code_execution: For calculations, data analysis, verified computations
# - sentiment: For emotional tone detection (automatic, always-on)
#
# All tools support intelligent fallback strategies when primary method fails.

tools:
  # Web Search Tool
  # Retrieves current information with source citations
  # Fallback: Ollama native search → DuckDuckGo → cached results
  web_search:
    enabled: true
    provider: duckduckgo  # Primary: duckduckgo, optional: brave (requires API key)
    offline_mode: false  # Set to true to disable network calls
    max_results: 10
    timeout_seconds: 15
    max_days_old: 30

  # RAG Memory Store Tool
  # Stores and retrieves personal information with encryption
  # Uses semantic search with embeddings for natural language queries
  # Embeddings: OpenRouter API (openai/text-embedding-3-small) when OPENROUTER_API_KEY set
  #            Falls back to mock embeddings (deterministic random) without API key
  rag:
    enabled: true
    provider: lancedb  # Vector database backend
    config:
      embedding_model: openai/text-embedding-3-small  # Via OpenRouter API
      embedding_dimension: 1536     # text-embedding-3-small dimension
      top_k: 5                      # Max memories to retrieve per query
      similarity_threshold: 0.7     # Minimum relevance score (0.0-1.0)
      max_context_length: 2000      # Max tokens from retrieved memories

  # Code Execution Tool
  # Safely executes Python code in sandboxed Docker containers
  # Security: Isolated network, limited resources, read-only filesystem
  code_execution:
    enabled: true
    provider: docker
    config:
      runtime: gvisor              # Enhanced security (optional, requires setup)
      timeout_seconds: 30          # Max execution time
      memory_limit_mb: 512         # Container memory limit
      allowed_packages:            # Pre-installed in sandbox image
        - numpy
        - pandas
        - matplotlib
      sandbox_image: python:3.11-slim  # Docker image (or kai-python-sandbox:latest)

  # Sentiment Analysis Tool
  # Detects emotional tone for adaptive response modes
  # Automatic: Runs before every query to adjust tone
  sentiment:
    enabled: true
    provider: vader  # VADER sentiment analyzer (fast, accurate)
    config:
      threshold_positive: 0.05     # Score above this = positive emotion
      threshold_negative: -0.05    # Score below this = negative emotion
      cache_results: true          # Cache per-query to avoid redundant analysis
